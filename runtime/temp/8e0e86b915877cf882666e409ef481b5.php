<?php /*a:3:{s:82:"/Users/mac/Desktop/ThinkAdmin-5/application/store/view/express_template/index.html";i:1564341490;s:64:"/Users/mac/Desktop/ThinkAdmin-5/application/admin/view/main.html";i:1564341490;s:87:"/Users/mac/Desktop/ThinkAdmin-5/application/store/view/express_template/index_item.html";i:1564341490;}*/ ?>
<div class="layui-card layui-bg-gray"><?php if(!(empty($title) || (($title instanceof \think\Collection || $title instanceof \think\Paginator ) && $title->isEmpty()))): ?><div class="layui-card-header layui-anim layui-anim-fadein notselect"><span class="layui-icon layui-icon-next font-s10 color-desc margin-right-5"></span><?php echo htmlentities((isset($title) && ($title !== '')?$title:'')); ?><div class="pull-right"></div></div><?php endif; ?><div class="layui-card-body layui-anim layui-anim-upbit"><form onsubmit="return false;" data-auto="true" action="<?php echo url('save'); ?>" method="post" class='layui-form layui-card' autocomplete="off"><div class="layui-card-body think-box-shadow padding-bottom-20 padding-left-40"><div data-item-container><?php foreach($list as $index=>$item): $is_default = '0'; $index = $index+1; $group_title = '邮费规则分组'; ?><fieldset class="margin-bottom-20 relative" data-max-index="<?php echo htmlentities($index); ?>"><legend class="color-green font-s14"><?php echo htmlentities((isset($group_title) && ($group_title !== '')?$group_title:'邮费规则分组')); ?><span class="color-desc font-s12"> RuleGroup</span></legend><?php if(empty($is_default) || (($is_default instanceof \think\Collection || $is_default instanceof \think\Paginator ) && $is_default->isEmpty())): ?><a onclick="delRuleItem(this)" class="layui-btn layui-btn-xs layui-btn-danger text-center layui-icon layui-icon-close" data-tips-text="移除规则" style="position:absolute;top:15px;right:5px;padding:0 5px"></a><?php endif; ?><div class="layui-form-item block relative"><span class="color-desc font-s14">订单总金额满足条件时将减免该订单的所有邮费（请谨慎配置）</span><table><tr><td><div class="layui-input text-center" style="width:150px"><?php isset($item['order_reduction_state']) or $item['order_reduction_state']=0; foreach(['0' => '关闭','1' => '开启'] as $k => $v): ?><!--<?php if($item['order_reduction_state'] == $k): ?>--><label class="think-radio"><input type="radio" value="<?php echo htmlentities($k); ?>" name="order_reduction_state_<?php echo htmlentities($index); ?>" title="<?php echo htmlentities($v); ?>" checked lay-ignore><?php echo htmlentities($v); ?></label><!--<?php else: ?>--><label class="think-radio"><input type="radio" value="<?php echo htmlentities($k); ?>" name="order_reduction_state_<?php echo htmlentities($index); ?>" title="<?php echo htmlentities($v); ?>" lay-ignore><?php echo htmlentities($v); ?></label><!--<?php endif; ?>--><?php endforeach; ?></div></td><td width='20px'></td><td><label class="text-center nowrap">
                        订单满 <input style="width:130px" class="layui-input inline-block text-center padding-left-0" name="order_reduction_price_<?php echo htmlentities($index); ?>" data-blur-number="2" value="<?php echo htmlentities((isset($item['order_reduction_price']) && ($item['order_reduction_price'] !== '')?$item['order_reduction_price']:'0.00')); ?>"> 元免邮费
                    </label></td></tr></table><!--<span class="color-desc block">订单总金额达到这个金额时，将减免该订单的所有邮费，请谨慎配置。</span>--></div><div class="layui-form-item"><?php if(!(empty($is_default) || (($is_default instanceof \think\Collection || $is_default instanceof \think\Paginator ) && $is_default->isEmpty()))): ?><input type="hidden" name="is_default_<?php echo htmlentities($index); ?>" value="1"><input type="hidden" name="rule_<?php echo htmlentities($index); ?>[]" value="<?php echo htmlentities((isset($group_title) && ($group_title !== '')?$group_title:'邮费规则分组')); ?>"><?php else: ?><input type="hidden" name="is_default_<?php echo htmlentities($index); ?>" value="0"><span class="color-desc font-s14">根据配送目的地的省份进行运费计算邮费（不在规则内的将使用默认邮费规则）</span><table class="layui-table" lay-skin="line"><tr class="layui-bg-gray"><th class="text-center"><label class="think-checkbox pull-left margin-top-0 notselect"><input type="checkbox" data-check-target="[data-template-province-<?php echo htmlentities($index); ?>]" lay-ignore> 全选
                    </label><span>可配送区域</span></th></tr><tr><td><?php foreach($provinces as $p): ?><label class="think-checkbox layui-elip notselect" style="width:115px"><?php if(is_numeric($index) and isset($item['rule']) and is_array($item['rule']) and in_array($p,$item['rule'])): ?><input data-province-input data-template-province-<?php echo htmlentities($index); ?> checked type="checkbox" name="rule_<?php echo htmlentities($index); ?>[]" value="<?php echo htmlentities($p); ?>" lay-ignore><?php echo htmlentities((isset($p) && ($p !== '')?$p:'')); else: ?><input data-province-input data-template-province-<?php echo htmlentities($index); ?> type="checkbox" name="rule_<?php echo htmlentities($index); ?>[]" value="<?php echo htmlentities($p); ?>" lay-ignore><?php echo htmlentities((isset($p) && ($p !== '')?$p:'')); ?><?php endif; ?></label><?php endforeach; ?></td></tr></table><?php endif; ?><table class="layui-table" lay-skin="line"><tr class="layui-bg-gray"><th class="text-center" width="80px">首件（个）</th><th class="text-center" width="80px">运费（元）</th><th class="text-center" width="80px">续件（个）</th><th class="text-center" width="80px">续费（元）</th></tr><tr><td class="text-center"><label><input name="first_number_<?php echo htmlentities($index); ?>" value="<?php echo htmlentities((isset($item['first_number']) && ($item['first_number'] !== '')?$item['first_number']:'1')); ?>" data-blur-number="0" class="layui-input text-center padding-left-0"></label></td><td class="text-center"><label><input name="first_price_<?php echo htmlentities($index); ?>" value="<?php echo htmlentities((isset($item['first_price']) && ($item['first_price'] !== '')?$item['first_price']:'0.00')); ?>" data-blur-number="2" class="layui-input text-center padding-left-0"></label></td><td class="text-center"><label><input name="next_number_<?php echo htmlentities($index); ?>" value="<?php echo htmlentities((isset($item['next_number']) && ($item['next_number'] !== '')?$item['next_number']:'1')); ?>" data-blur-number="0" class="layui-input text-center padding-left-0"></label></td><td class="text-center"><label><input name="next_price_<?php echo htmlentities($index); ?>" value="<?php echo htmlentities((isset($item['next_price']) && ($item['next_price'] !== '')?$item['next_price']:'0.00')); ?>" data-blur-number="2" class="layui-input text-center padding-left-0"></label></td></tr></table></div></fieldset><?php endforeach; ?></div><div class="margin-bottom-20"><a onclick="addRuleItem()" class="layui-btn layui-btn-warm">添加邮费规则分组</a></div><?php $index = '0'; $is_default = '1'; $group_title = '默认邮费规则'; $item = $default; ?><fieldset class="margin-bottom-20 relative" data-max-index="<?php echo htmlentities($index); ?>"><legend class="color-green font-s14"><?php echo htmlentities((isset($group_title) && ($group_title !== '')?$group_title:'邮费规则分组')); ?><span class="color-desc font-s12"> RuleGroup</span></legend><?php if(empty($is_default) || (($is_default instanceof \think\Collection || $is_default instanceof \think\Paginator ) && $is_default->isEmpty())): ?><a onclick="delRuleItem(this)" class="layui-btn layui-btn-xs layui-btn-danger text-center layui-icon layui-icon-close" data-tips-text="移除规则" style="position:absolute;top:15px;right:5px;padding:0 5px"></a><?php endif; ?><div class="layui-form-item block relative"><span class="color-desc font-s14">订单总金额满足条件时将减免该订单的所有邮费（请谨慎配置）</span><table><tr><td><div class="layui-input text-center" style="width:150px"><?php isset($item['order_reduction_state']) or $item['order_reduction_state']=0; foreach(['0' => '关闭','1' => '开启'] as $k => $v): ?><!--<?php if($item['order_reduction_state'] == $k): ?>--><label class="think-radio"><input type="radio" value="<?php echo htmlentities($k); ?>" name="order_reduction_state_<?php echo htmlentities($index); ?>" title="<?php echo htmlentities($v); ?>" checked lay-ignore><?php echo htmlentities($v); ?></label><!--<?php else: ?>--><label class="think-radio"><input type="radio" value="<?php echo htmlentities($k); ?>" name="order_reduction_state_<?php echo htmlentities($index); ?>" title="<?php echo htmlentities($v); ?>" lay-ignore><?php echo htmlentities($v); ?></label><!--<?php endif; ?>--><?php endforeach; ?></div></td><td width='20px'></td><td><label class="text-center nowrap">
                        订单满 <input style="width:130px" class="layui-input inline-block text-center padding-left-0" name="order_reduction_price_<?php echo htmlentities($index); ?>" data-blur-number="2" value="<?php echo htmlentities((isset($item['order_reduction_price']) && ($item['order_reduction_price'] !== '')?$item['order_reduction_price']:'0.00')); ?>"> 元免邮费
                    </label></td></tr></table><!--<span class="color-desc block">订单总金额达到这个金额时，将减免该订单的所有邮费，请谨慎配置。</span>--></div><div class="layui-form-item"><?php if(!(empty($is_default) || (($is_default instanceof \think\Collection || $is_default instanceof \think\Paginator ) && $is_default->isEmpty()))): ?><input type="hidden" name="is_default_<?php echo htmlentities($index); ?>" value="1"><input type="hidden" name="rule_<?php echo htmlentities($index); ?>[]" value="<?php echo htmlentities((isset($group_title) && ($group_title !== '')?$group_title:'邮费规则分组')); ?>"><?php else: ?><input type="hidden" name="is_default_<?php echo htmlentities($index); ?>" value="0"><span class="color-desc font-s14">根据配送目的地的省份进行运费计算邮费（不在规则内的将使用默认邮费规则）</span><table class="layui-table" lay-skin="line"><tr class="layui-bg-gray"><th class="text-center"><label class="think-checkbox pull-left margin-top-0 notselect"><input type="checkbox" data-check-target="[data-template-province-<?php echo htmlentities($index); ?>]" lay-ignore> 全选
                    </label><span>可配送区域</span></th></tr><tr><td><?php foreach($provinces as $p): ?><label class="think-checkbox layui-elip notselect" style="width:115px"><?php if(is_numeric($index) and isset($item['rule']) and is_array($item['rule']) and in_array($p,$item['rule'])): ?><input data-province-input data-template-province-<?php echo htmlentities($index); ?> checked type="checkbox" name="rule_<?php echo htmlentities($index); ?>[]" value="<?php echo htmlentities($p); ?>" lay-ignore><?php echo htmlentities((isset($p) && ($p !== '')?$p:'')); else: ?><input data-province-input data-template-province-<?php echo htmlentities($index); ?> type="checkbox" name="rule_<?php echo htmlentities($index); ?>[]" value="<?php echo htmlentities($p); ?>" lay-ignore><?php echo htmlentities((isset($p) && ($p !== '')?$p:'')); ?><?php endif; ?></label><?php endforeach; ?></td></tr></table><?php endif; ?><table class="layui-table" lay-skin="line"><tr class="layui-bg-gray"><th class="text-center" width="80px">首件（个）</th><th class="text-center" width="80px">运费（元）</th><th class="text-center" width="80px">续件（个）</th><th class="text-center" width="80px">续费（元）</th></tr><tr><td class="text-center"><label><input name="first_number_<?php echo htmlentities($index); ?>" value="<?php echo htmlentities((isset($item['first_number']) && ($item['first_number'] !== '')?$item['first_number']:'1')); ?>" data-blur-number="0" class="layui-input text-center padding-left-0"></label></td><td class="text-center"><label><input name="first_price_<?php echo htmlentities($index); ?>" value="<?php echo htmlentities((isset($item['first_price']) && ($item['first_price'] !== '')?$item['first_price']:'0.00')); ?>" data-blur-number="2" class="layui-input text-center padding-left-0"></label></td><td class="text-center"><label><input name="next_number_<?php echo htmlentities($index); ?>" value="<?php echo htmlentities((isset($item['next_number']) && ($item['next_number'] !== '')?$item['next_number']:'1')); ?>" data-blur-number="0" class="layui-input text-center padding-left-0"></label></td><td class="text-center"><label><input name="next_price_<?php echo htmlentities($index); ?>" value="<?php echo htmlentities((isset($item['next_price']) && ($item['next_price'] !== '')?$item['next_price']:'0.00')); ?>" data-blur-number="2" class="layui-input text-center padding-left-0"></label></td></tr></table></div></fieldset><div class="hr-line-dashed"></div><div class="layui-form-item text-center"><button class="layui-btn" type='submit'>保存数据</button></div></div></form><script>
    form.render();
    checkRuleItem();

    function delRuleItem(that) {
        $.msg.confirm('确定要移除这个邮费规则吗？', function (index) {
            $(that).parent('fieldset').remove(), $.msg.close(index);
            checkRuleItem();
        })
    }

    function addRuleItem() {
        this.itemIndex = $('[data-item-container] fieldset:last').attr('data-max-index') || 0;
        this.html = $('#template').html().replace(/\[index\]/gi, parseInt(this.itemIndex) + 1);
        $('[data-item-container]').append(this.html);
    }

    function checkRuleItem() {
        if ($('[data-item-container] fieldset').length < 1) {
            //  addRuleItem();
        }
    }

    (function (opt) {
        opt.selecter = 'input[type=checkbox][data-province-input]';
        $('body').off('change', opt.selecter).on('change', opt.selecter, function () {
            if (this.checked) $(opt.selecter + '[value="' + this.value + '"]').not(this).map(function () {
                if (this.checked) $(this).trigger('click');
            });
        });
    })({});

</script><?php $is_default = '0'; $index = '[index]'; $group_title = '邮费规则分组'; $item=[]; ?><div class="layui-hide" id="template"><fieldset class="margin-bottom-20 relative" data-max-index="<?php echo htmlentities($index); ?>"><legend class="color-green font-s14"><?php echo htmlentities((isset($group_title) && ($group_title !== '')?$group_title:'邮费规则分组')); ?><span class="color-desc font-s12"> RuleGroup</span></legend><?php if(empty($is_default) || (($is_default instanceof \think\Collection || $is_default instanceof \think\Paginator ) && $is_default->isEmpty())): ?><a onclick="delRuleItem(this)" class="layui-btn layui-btn-xs layui-btn-danger text-center layui-icon layui-icon-close" data-tips-text="移除规则" style="position:absolute;top:15px;right:5px;padding:0 5px"></a><?php endif; ?><div class="layui-form-item block relative"><span class="color-desc font-s14">订单总金额满足条件时将减免该订单的所有邮费（请谨慎配置）</span><table><tr><td><div class="layui-input text-center" style="width:150px"><?php isset($item['order_reduction_state']) or $item['order_reduction_state']=0; foreach(['0' => '关闭','1' => '开启'] as $k => $v): ?><!--<?php if($item['order_reduction_state'] == $k): ?>--><label class="think-radio"><input type="radio" value="<?php echo htmlentities($k); ?>" name="order_reduction_state_<?php echo htmlentities($index); ?>" title="<?php echo htmlentities($v); ?>" checked lay-ignore><?php echo htmlentities($v); ?></label><!--<?php else: ?>--><label class="think-radio"><input type="radio" value="<?php echo htmlentities($k); ?>" name="order_reduction_state_<?php echo htmlentities($index); ?>" title="<?php echo htmlentities($v); ?>" lay-ignore><?php echo htmlentities($v); ?></label><!--<?php endif; ?>--><?php endforeach; ?></div></td><td width='20px'></td><td><label class="text-center nowrap">
                        订单满 <input style="width:130px" class="layui-input inline-block text-center padding-left-0" name="order_reduction_price_<?php echo htmlentities($index); ?>" data-blur-number="2" value="<?php echo htmlentities((isset($item['order_reduction_price']) && ($item['order_reduction_price'] !== '')?$item['order_reduction_price']:'0.00')); ?>"> 元免邮费
                    </label></td></tr></table><!--<span class="color-desc block">订单总金额达到这个金额时，将减免该订单的所有邮费，请谨慎配置。</span>--></div><div class="layui-form-item"><?php if(!(empty($is_default) || (($is_default instanceof \think\Collection || $is_default instanceof \think\Paginator ) && $is_default->isEmpty()))): ?><input type="hidden" name="is_default_<?php echo htmlentities($index); ?>" value="1"><input type="hidden" name="rule_<?php echo htmlentities($index); ?>[]" value="<?php echo htmlentities((isset($group_title) && ($group_title !== '')?$group_title:'邮费规则分组')); ?>"><?php else: ?><input type="hidden" name="is_default_<?php echo htmlentities($index); ?>" value="0"><span class="color-desc font-s14">根据配送目的地的省份进行运费计算邮费（不在规则内的将使用默认邮费规则）</span><table class="layui-table" lay-skin="line"><tr class="layui-bg-gray"><th class="text-center"><label class="think-checkbox pull-left margin-top-0 notselect"><input type="checkbox" data-check-target="[data-template-province-<?php echo htmlentities($index); ?>]" lay-ignore> 全选
                    </label><span>可配送区域</span></th></tr><tr><td><?php foreach($provinces as $p): ?><label class="think-checkbox layui-elip notselect" style="width:115px"><?php if(is_numeric($index) and isset($item['rule']) and is_array($item['rule']) and in_array($p,$item['rule'])): ?><input data-province-input data-template-province-<?php echo htmlentities($index); ?> checked type="checkbox" name="rule_<?php echo htmlentities($index); ?>[]" value="<?php echo htmlentities($p); ?>" lay-ignore><?php echo htmlentities((isset($p) && ($p !== '')?$p:'')); else: ?><input data-province-input data-template-province-<?php echo htmlentities($index); ?> type="checkbox" name="rule_<?php echo htmlentities($index); ?>[]" value="<?php echo htmlentities($p); ?>" lay-ignore><?php echo htmlentities((isset($p) && ($p !== '')?$p:'')); ?><?php endif; ?></label><?php endforeach; ?></td></tr></table><?php endif; ?><table class="layui-table" lay-skin="line"><tr class="layui-bg-gray"><th class="text-center" width="80px">首件（个）</th><th class="text-center" width="80px">运费（元）</th><th class="text-center" width="80px">续件（个）</th><th class="text-center" width="80px">续费（元）</th></tr><tr><td class="text-center"><label><input name="first_number_<?php echo htmlentities($index); ?>" value="<?php echo htmlentities((isset($item['first_number']) && ($item['first_number'] !== '')?$item['first_number']:'1')); ?>" data-blur-number="0" class="layui-input text-center padding-left-0"></label></td><td class="text-center"><label><input name="first_price_<?php echo htmlentities($index); ?>" value="<?php echo htmlentities((isset($item['first_price']) && ($item['first_price'] !== '')?$item['first_price']:'0.00')); ?>" data-blur-number="2" class="layui-input text-center padding-left-0"></label></td><td class="text-center"><label><input name="next_number_<?php echo htmlentities($index); ?>" value="<?php echo htmlentities((isset($item['next_number']) && ($item['next_number'] !== '')?$item['next_number']:'1')); ?>" data-blur-number="0" class="layui-input text-center padding-left-0"></label></td><td class="text-center"><label><input name="next_price_<?php echo htmlentities($index); ?>" value="<?php echo htmlentities((isset($item['next_price']) && ($item['next_price'] !== '')?$item['next_price']:'0.00')); ?>" data-blur-number="2" class="layui-input text-center padding-left-0"></label></td></tr></table></div></fieldset></div></div></div>